{"is_source_file": true, "format": "Python", "description": "This Python source file defines a set of REST API endpoints for managing vulnerabilities, including creating, listing, retrieving, updating, and deleting vulnerabilities. It uses FastAPI and SQLAlchemy for asynchronous database interaction and incorporates authentication and authorization mechanisms.", "external_files": ["app.auth.dependencies", "app.common.errors", "app.dependencies.db", "app.domain.errors", "app.domain.schemas", "app.domain.services"], "external_methods": ["get_current_user", "require_roles", "get_db_session", "VulnerabilityService.create", "VulnerabilityService.list", "VulnerabilityService.get", "VulnerabilityService.update", "VulnerabilityService.delete", "VulnerabilityRead.model_validate"], "published": ["router"], "classes": [], "methods": [{"name": "VulnerabilityRead create_vulnerability( payload: VulnerabilityCreate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )", "description": "Creates a new vulnerability entry using input data and the current user context.", "scope": "", "scopeKind": ""}, {"name": "ListResponse[VulnerabilityRead] list_vulnerabilities( limit: int = Query(default=50, ge=1, le=500, description=\"Maximum number of items to return.\"), offset: int = Query(default=0, ge=0, description=\"Number of items to skip.\"), project_id: Optional[UUID] = Query(default=None, description=\"Filter by project id.\"), severity: Optional[str] = Query(default=None, description=\"Filter by severity.\"), status_filter: Optional[str] = Query(default=None, alias=\"status\", description=\"Filter by status.\"), q: Optional[str] = Query(default=None, description=\"Optional title search (case-insensitive, contains).\"), db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )", "description": "Retrieves a paginated list of vulnerabilities, with optional filters for project, severity, status, and search query.", "scope": "", "scopeKind": ""}, {"name": "VulnerabilityRead get_vulnerability( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )", "description": "Fetches details of a specific vulnerability by its UUID.", "scope": "", "scopeKind": ""}, {"name": "VulnerabilityRead update_vulnerability( vulnerability_id: UUID, payload: VulnerabilityUpdate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )", "description": "Partially updates an existing vulnerability identified by UUID.", "scope": "", "scopeKind": ""}, {"name": "None delete_vulnerability( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Depends(require_roles([\"admin\", \"realm-admin\"])), )", "description": "Deletes a vulnerability, restricted to users with admin roles.", "scope": "", "scopeKind": ""}], "calls": ["VulnerabilityService.create", "VulnerabilityService.list", "VulnerabilityService.get", "VulnerabilityService.update", "VulnerabilityService.delete", "VulnerabilityRead.model_validate"], "search-terms": ["Vulnerability CRUD", "/vulnerabilities", "FastAPI", "async", "UUID", "list vulnerabilities", "create vulnerability", "update vulnerability", "delete vulnerability"], "state": 2, "file_id": 43, "knowledge_revision": 99, "git_revision": "ac244c573ee69c92dd8ff8571658ce97ccbd030b", "ctags": [{"_type": "tag", "name": "create_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def create_vulnerability($/", "language": "Python", "typeref": "typename:VulnerabilityRead", "kind": "function", "signature": "( payload: VulnerabilityCreate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )"}, {"_type": "tag", "name": "delete_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def delete_vulnerability($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Depends(require_roles([\"admin\", \"realm-admin\"])), )"}, {"_type": "tag", "name": "get_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def get_vulnerability($/", "language": "Python", "typeref": "typename:VulnerabilityRead", "kind": "function", "signature": "( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )"}, {"_type": "tag", "name": "list_vulnerabilities", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def list_vulnerabilities($/", "language": "Python", "typeref": "typename:ListResponse[VulnerabilityRead]", "kind": "function", "signature": "( limit: int = Query(default=50, ge=1, le=500, description=\"Maximum number of items to return.\"), offset: int = Query(default=0, ge=0, description=\"Number of items to skip.\"), project_id: Optional[UUID] = Query(default=None, description=\"Filter by project id.\"), severity: Optional[str] = Query(default=None, description=\"Filter by severity.\"), status_filter: Optional[str] = Query(default=None, alias=\"status\", description=\"Filter by status.\"), q: Optional[str] = Query(default=None, description=\"Optional title search (case-insensitive, contains).\"), db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^router = APIRouter(prefix=\"\\/vulnerabilities\", tags=[\"Vulnerabilities\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def update_vulnerability($/", "language": "Python", "typeref": "typename:VulnerabilityRead", "kind": "function", "signature": "( vulnerability_id: UUID, payload: VulnerabilityUpdate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )"}], "hash": "d4b16dd51b88c14e68b9c97b9bdd7e22", "format-version": 4, "code-base-name": "rest-api-modernized", "filename": "app/routers/vulnerabilities.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/vulnerabilities\", tags=[\"Vulnerabilities\"])", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"99": "ac244c573ee69c92dd8ff8571658ce97ccbd030b"}]}