{"is_source_file": true, "format": "Python", "description": "This file defines REST API endpoints for managing vulnerabilities, including creation, listing, retrieval, updating, and deletion. It uses FastAPI for routing and dependency injection, and interacts with a VulnerabilityService for business logic.", "external_files": ["app.auth.dependencies", "app.common.errors", "app.dependencies.db", "app.domain.schemas", "app.domain.services"], "external_methods": ["get_current_user", "require_roles", "get_db_session", "VulnerabilityService.create", "VulnerabilityService.list", "VulnerabilityService.get", "VulnerabilityService.update", "VulnerabilityService.delete"], "published": ["create_vulnerability", "list_vulnerabilities", "get_vulnerability", "update_vulnerability", "delete_vulnerability"], "classes": [], "methods": [{"name": "VulnerabilityRead create_vulnerability( payload: VulnerabilityCreate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )", "description": "Endpoint for creating a new vulnerability; accepts a VulnerabilityCreate payload and returns a VulnerabilityRead.", "scope": "", "scopeKind": ""}, {"name": "ListResponse[VulnerabilityRead] list_vulnerabilities( limit: int = Query(default=50, ge=1, le=500, description=\"Maximum number of items to return.\"), offset: int = Query(default=0, ge=0, description=\"Number of items to skip.\"), project_id: Optional[UUID] = Query(default=None, description=\"Filter by project id.\"), severity: Optional[str] = Query(default=None, description=\"Filter by severity.\"), status_filter: Optional[str] = Query(default=None, alias=\"status\", description=\"Filter by status.\"), q: Optional[str] = Query(default=None, description=\"Optional title search (case-insensitive, contains).\"), db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )", "description": "Endpoint for listing vulnerabilities with pagination and filtering options; returns a ListResponse of VulnerabilityRead objects.", "scope": "", "scopeKind": ""}, {"name": "VulnerabilityRead get_vulnerability( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )", "description": "Retrieve a single vulnerability by its UUID.", "scope": "", "scopeKind": ""}, {"name": "VulnerabilityRead update_vulnerability( vulnerability_id: UUID, payload: VulnerabilityUpdate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )", "description": "Partially update an existing vulnerability specified by UUID with provided fields.", "scope": "", "scopeKind": ""}, {"name": "None delete_vulnerability( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Depends(require_roles([\"admin\", \"realm-admin\"])), )", "description": "Delete a vulnerability by its UUID; restricted to users with role 'admin' or 'realm-admin'.", "scope": "", "scopeKind": ""}], "calls": ["VulnerabilityService(db).create", "VulnerabilityService(db).list", "VulnerabilityService(db).get", "VulnerabilityService(db).update", "VulnerabilityService(db).delete"], "search-terms": ["vulnerabilities", "VulnerabilityService", "FastAPI endpoints", "create, list, get, update, delete", "security dependencies", "UUID vulnerability_id"], "state": 2, "file_id": 43, "knowledge_revision": 107, "git_revision": "e6384165a844054d79619f77ee0d4e438cd1d35f", "revision_history": [{"99": "ac244c573ee69c92dd8ff8571658ce97ccbd030b"}, {"107": "e6384165a844054d79619f77ee0d4e438cd1d35f"}], "ctags": [{"_type": "tag", "name": "create_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def create_vulnerability($/", "language": "Python", "typeref": "typename:VulnerabilityRead", "kind": "function", "signature": "( payload: VulnerabilityCreate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )"}, {"_type": "tag", "name": "delete_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def delete_vulnerability($/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Depends(require_roles([\"admin\", \"realm-admin\"])), )"}, {"_type": "tag", "name": "get_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def get_vulnerability($/", "language": "Python", "typeref": "typename:VulnerabilityRead", "kind": "function", "signature": "( vulnerability_id: UUID, db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )"}, {"_type": "tag", "name": "list_vulnerabilities", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def list_vulnerabilities($/", "language": "Python", "typeref": "typename:ListResponse[VulnerabilityRead]", "kind": "function", "signature": "( limit: int = Query(default=50, ge=1, le=500, description=\"Maximum number of items to return.\"), offset: int = Query(default=0, ge=0, description=\"Number of items to skip.\"), project_id: Optional[UUID] = Query(default=None, description=\"Filter by project id.\"), severity: Optional[str] = Query(default=None, description=\"Filter by severity.\"), status_filter: Optional[str] = Query(default=None, alias=\"status\", description=\"Filter by status.\"), q: Optional[str] = Query(default=None, description=\"Optional title search (case-insensitive, contains).\"), db: AsyncSession = Depends(get_db_session), _user: AuthenticatedUser = Security(get_current_user), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^router = APIRouter(prefix=\"\\/vulnerabilities\", tags=[\"Vulnerabilities\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_vulnerability", "path": "/home/kavia/workspace/code-generation/rest-api-modernized/app/routers/vulnerabilities.py", "pattern": "/^async def update_vulnerability($/", "language": "Python", "typeref": "typename:VulnerabilityRead", "kind": "function", "signature": "( vulnerability_id: UUID, payload: VulnerabilityUpdate, db: AsyncSession = Depends(get_db_session), user: AuthenticatedUser = Security(get_current_user), )"}], "hash": "94ec358ef16114899f288d932389d56e", "format-version": 4, "code-base-name": "rest-api-modernized", "filename": "app/routers/vulnerabilities.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/vulnerabilities\", tags=[\"Vulnerabilities\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}